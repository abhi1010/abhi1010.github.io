<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>C on Coders Digest</title>
    <link>http://abhipandey.com/tags/c/</link>
    <description>Recent content in C on Coders Digest</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 28 Jun 2016 23:26:44 +0800</lastBuildDate>
    <atom:link href="http://abhipandey.com/tags/c/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Protobuf on Docker</title>
      <link>http://abhipandey.com/2016/06/protobuf-on-docker/</link>
      <pubDate>Tue, 28 Jun 2016 23:26:44 +0800</pubDate>
      
      <guid>http://abhipandey.com/2016/06/protobuf-on-docker/</guid>
      <description>

&lt;p&gt;Found it really strange that nobody had mentioned on their blog how to
compile &lt;code&gt;Protobuf&lt;/code&gt; in python with &lt;strong&gt;C++&lt;/strong&gt; implementation.&lt;/p&gt;

&lt;p&gt;I had been having a lot of trouble with the compilation of python protobuf.
After struggling with it for a few months on and off I decided to give &lt;strong&gt;&lt;code&gt;Docker&lt;/code&gt;&lt;/strong&gt;
 a try as I realized that my own Fedora OS may be the one having troubles.
 Thought of starting with &lt;strong&gt;Ubuntu&lt;/strong&gt; Docker as I&amp;rsquo;ve had success with it earlier
 with such compilation scripts. Luckily it all worked out successfully again
 for protobuf.&lt;/p&gt;

&lt;p&gt;Then I tried Docker for &lt;strong&gt;Centos 7 and Fedora 23&lt;/strong&gt;, both of which had not
 been working for me in any shape.&lt;/p&gt;

&lt;p&gt;The source code of the &lt;strong&gt;Dockerfiles&lt;/strong&gt; are available on Github here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/abhi1010/protobuf-on-docker&#34;&gt;github/abhi1010/protobuf-on-docker&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We are running all the steps through the docker image so that the steps can be replicated
 with any &lt;a href=&#34;https://github.com/google/protobuf/releases&#34;&gt;protobuf source code release&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Here&amp;rsquo;s what we will be doing:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Create &lt;code&gt;protoc&lt;/code&gt; compiler by compiling C++ files&lt;/li&gt;
&lt;li&gt;Compile &lt;a href=&#34;https://github.com/google/protobuf/tree/master/python#c-implementation&#34;&gt;C++ implementation for &lt;code&gt;python&lt;/code&gt;&lt;/a&gt;
using the just created &lt;code&gt;protoc&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Dockerfiles are available for the following Operating Systems:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/abhi1010/protobuf-on-docker/blob/master/centos-7.1/Dockerfile&#34;&gt;Centos 7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/abhi1010/protobuf-on-docker/blob/master/fedora-23/Dockerfile&#34;&gt;Fedora 23&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/abhi1010/protobuf-on-docker/blob/master/ubuntu-15/Dockerfile&#34;&gt;Ubuntu 15&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;where-to-find-the-files-inside-the-docker-images:59fece5fea31b5834dfd3c1b99d2e930&#34;&gt;Where to find the files inside the Docker images&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;protoc&lt;/code&gt; compiler is available at &lt;code&gt;/ws/protoc-3.2&lt;/code&gt; folder inside the images&lt;/li&gt;
&lt;li&gt;&lt;code&gt;python&lt;/code&gt; version (compiled from c++) is available at &lt;code&gt;/ws/protobuf-3.0.0-beta-3.2/python/dist/&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You can copy out the files using the following commands:&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color: #ce5c00; font-weight: bold&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color: #204a87; font-weight: bold&#34;&gt;$(&lt;/span&gt;sudo docker create &amp;lt;image_name&amp;gt;&lt;span style=&#34;color: #204a87; font-weight: bold&#34;&gt;)&lt;/span&gt;
sudo docker cp &lt;span style=&#34;color: #000000&#34;&gt;$id&lt;/span&gt;:/ws/protoc-3.2 ./
sudo docker cp &lt;span style=&#34;color: #000000&#34;&gt;$id&lt;/span&gt;:/ws/protobuf-3.0.0-beta-3.2/python/dist/*.gz ./
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;In case you get an error like the following, &lt;em&gt;remove&lt;/em&gt; &lt;code&gt;*.gz&lt;/code&gt; from the cp command:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;zsh: no matches found: e7c8a9102e1cd07b4c471c331bc4deba2222278eb22be1e79ecaa14e914ed654:/ws/protobuf-3.0.0-beta-3.2/python/dist/*.gz
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Your second cp command then becomes:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo docker cp $id:/ws/protobuf-3.0.0-beta-3.2/python/dist/ ./
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Once done, you can remove the created container with the following command:&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;sudo docker rm -v &lt;span style=&#34;color: #000000&#34;&gt;$id&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Just remember to change the rights as the files will belong to &lt;code&gt;root&lt;/code&gt; by default.
You can do that with the following commands:&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;sudo chown -R &amp;lt;USERNAME&amp;gt;:&amp;lt;USERNAME&amp;gt; *
&lt;/pre&gt;&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>